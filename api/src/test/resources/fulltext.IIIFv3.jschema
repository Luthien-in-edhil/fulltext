{
    "$schema": "http://www.europeana.eu/schemas/json/iiif#",
    "title": "IIIF Full-text API v3 schema",
    "oneOf": [
        { "$ref": "#/definitions/annopage" },
		{ "$ref": "#/definitions/anno" }
    ],
    "definitions": {
        "context": {
            "type": "array",
            "minItems": 2, 
            "items": { "enum": [ "http://iiif.io/api/presentation/3/context.json"
			                   , "https://www.europeana.eu/schemas/context/edm.jsonld" ] }
        },
		"annopage": {
            "type": "object",
            "properties": {
                "@context": { "$ref": "#/definitions/context"    },
                "id"      : { "type": "string", "format": "uri"  },
                "type"    : { "enum": [ "AnnotationPage" ]       },
                "items"   : { "type": "array", "minItems": 0, "items": { "$ref": "#/definitions/anno"  } }
             },
            "required": [ "id", "type", "items" ],
            "additionalProperties": false
        },
		"anno": {
            "type": "object",
            "properties": {
                "@context"   : { "$ref": "#/definitions/context"             },
                "id"         : { "type": "string", "format": "uri"           },
                "type"       : { "enum": [ "Annotation" ]                    },
				"motivation" : { "enum": [ "transcribing"   ]                },
				"dcType"     : { "enum": [ "Page", "Block", "Line", "Word" , "Media" , "Caption" ] },
				"body"       : { "$ref": "#/definitions/body"                },
				"target"     : { "$ref": "#/definitions/targets"             }

		    },
            "required": [ "id", "type", "motivation", "dcType", "body", "target" ],
            "additionalProperties": false
        },
        "body": {
            "type": "object",
            "properties": {
                "id": { "type": "string", "format": "uri" }
            },
            "required": [ "id" ],
            "additionalProperties": false
        },
        "targets": {
            "type": "array",
            "minItems": 1, 
            "items": { "type": "string",  "format": "uri" }
        }
    }
}